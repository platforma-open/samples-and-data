tpl := import("@platforma-sdk/workflow-tengo:tpl")
text := import("text")
slices := import("@platforma-sdk/workflow-tengo:slices")
file := import("@platforma-sdk/workflow-tengo:file")
exec := import("@platforma-sdk/workflow-tengo:exec")

tpl.defineOutputs("samplesCsv")

tpl.body(func(inputs) {
    header := text.trim_space(string(inputs.header.getData()))
    delimiter := inputs.delimiter
    samples := text.split(header, delimiter)

    splice(samples, 0, 1)
    slices.quickSortInPlace(samples)
    csvContent := text.join(samples, "\n")

    //TODO: what dummy command should be used?
    writeFile := exec.builder().
        cmd("ls").
        writeFile("samples.csv", csvContent).
        saveFile("samples.csv").
        run()

    return {
        samplesCsv: file.exportFile(writeFile.getFile("samples.csv"))
    }
})